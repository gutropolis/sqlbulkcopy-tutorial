---
layout: default
title: The DestinationTableName property must be set before calling this method.
permalink: destinationtablename-property-must-be-set
---

{% include template-h1.html %}

{% include begin-block-h2.html title='Problem' %}

<p>
The method WriteToServer throw the following error:
</p>

[Something Error: The DestinationTableName property must be set before calling this method.]


{% include end-block-h2.html %}

{% include begin-block-h2.html title='Solution' %}
This error is caused because to value has been set to the DestinationTableName property.

{% include begin-code.html %}
{% highlight csharp %}
using (var connection = new SqlConnection(My.Config.ConnectionStrings.BulkOperations))
{
    connection.Open();

    using (var bulkCopy = new SqlBulkCopy(connection))
    {
        bulkCopy.ColumnMappings.Add("ColumnIntTest", "ColumnIntTest");
        bulkCopy.ColumnMappings.Add("ColumnStringTest", "ColumnStringTest");

        bulkCopy.WriteToServer(dt);
    }
}
{% endhighlight %}
{% include end-code.html %}
{% include end-block-h2.html %}
